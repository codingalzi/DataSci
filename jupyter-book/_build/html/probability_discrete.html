
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>12. 이산 확률 분포 &#8212; 데이터 사이언스 기초</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'probability_discrete';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="13. 연속 확률 분포" href="probability_continuous.html" />
    <link rel="prev" title="11. 확률 분포" href="probability.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">데이터 사이언스 기초</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lists_dicts.html">1. 리스트와 사전</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays.html">2. 넘파이 어레이</a></li>
<li class="toctree-l1"><a class="reference internal" href="series.html">3. 판다스 시리즈</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataframes.html">4. 판다스 데이터프레임</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_handling.html">5. 데이터 다루기</a></li>
<li class="toctree-l1"><a class="reference internal" href="oneD_data.html">6. 1차원 데이터</a></li>
<li class="toctree-l1"><a class="reference internal" href="oneD_visualization.html">7. 1차원 데이터 시각화</a></li>
<li class="toctree-l1"><a class="reference internal" href="twoD_data.html">8. 2차원 데이터</a></li>
<li class="toctree-l1"><a class="reference internal" href="twoD_visualization.html">9. 2차원 데이터 시각화</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">10. 모집단과 표본</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability.html">11. 확률 분포</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">12. 이산 확률 분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability_continuous.html">13. 연속 확률 분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="expected_values.html">14. 기댓값과 분산</a></li>
<li class="toctree-l1"><a class="reference internal" href="normal_distribution.html">15. 정규분포</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample_distribution.html">16. 표본분포(준비중)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/codingalzi/DataSci/blob/master/jupyter-book/probability_discrete.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/codingalzi/DataSci" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/codingalzi/DataSci/issues/new?title=Issue%20on%20page%20%2Fprobability_discrete.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/probability_discrete.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>이산 확률 분포</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">12.1. 이산 확률변수</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pmf">12.1.1. 확률 질량 함수(PMF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdf">12.1.2. 누적 분포 함수(CDF)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">12.2. 다변량 분포</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">12.2.1. 이산 결합 확률 분포</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">12.2.2. 조건부 확률</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">12.2.3. 주변 확률 분포</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">12.3. 연습문제</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ch-probability-discrete">
<span id="id1"></span><h1><span class="section-number">12. </span>이산 확률 분포<a class="headerlink" href="#ch-probability-discrete" title="Link to this heading">#</a></h1>
<p><strong>기본 설정</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code>와 <code class="docutils literal notranslate"><span class="pre">pandas</span></code> 라이브러리를 각각 <code class="docutils literal notranslate"><span class="pre">np</span></code>와 <code class="docutils literal notranslate"><span class="pre">pd</span></code>로 불러온다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>데이터프레임의 <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy">chained indexing을 금지시키기 위한 설정</a>을 지정한다.
Pandas 3.0 버전부터는 기본 옵션으로 지정된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">copy_on_write</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<p>주피터 노트북에서 부동소수점의 출력을 소수점 이하 6자리로 제한한다.
아래 코드는 주피터 노트북에서만 사용하며 일반적인 파이썬 코드가 아니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">precision</span> 6
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;%.6f&#39;
</pre></div>
</div>
</div>
</div>
<p>아래 코드는 데이터프레임 내에서 부동소수점의 출력을 소수점 이하 6자리로 제한한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>데이터 시각화를 위해 <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>를 <code class="docutils literal notranslate"><span class="pre">plt</span></code>라는 별칭으로 불러온다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p><strong>데이터 저장소 디렉토리</strong></p>
<p>코드에 사용되는 <a class="reference external" href="https://github.com/codingalzi/DataSci/tree/master/data">데이터 저장소의 기본 디렉토리</a>를 지정한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/codingalzi/DataSci/refs/heads/master/data/&#39;</span>
</pre></div>
</div>
</div>
</div>
<p><strong>주요 내용</strong></p>
<p>이산 확률 분포의 주요 개념을 소개한다.</p>
<ul class="simple">
<li><p>이산 확률변수</p></li>
<li><p>이산 확률 분포</p></li>
<li><p>확률 질량 함수</p></li>
<li><p>누적 분포 함수</p></li>
</ul>
<section id="id2">
<h2><span class="section-number">12.1. </span>이산 확률변수<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="probability.html#ch-probability"><span class="std std-numref">11장</span></a>에서 살펴본 확률변수는 해당 변수에 할당될 수 있는 값과 그 값이
발생할 확률에 의해 정의되었으며, 확률 분포는 이를 정리한 결과다.</p>
<p>예를 들어 한 개의 정상적인 주사위를 던졌을 때 나올 수 있는 값을 가리키는 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의
확률 분포는 다음과 같다.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Y</p></th>
<th class="head text-center"><p>1</p></th>
<th class="head text-center"><p>2</p></th>
<th class="head text-center"><p>3</p></th>
<th class="head text-center"><p>4</p></th>
<th class="head text-center"><p>5</p></th>
<th class="head text-center"><p>6</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>확률</p></td>
<td class="text-center"><p>1/6</p></td>
<td class="text-center"><p>1/6</p></td>
<td class="text-center"><p>1/6</p></td>
<td class="text-center"><p>1/6</p></td>
<td class="text-center"><p>1/6</p></td>
<td class="text-center"><p>1/6</p></td>
</tr>
</tbody>
</table>
</div>
<p>반면에 캘리포니아 주택가격 데이터셋에서 임의로 선택된 구역의 소득 범주를 가리키는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>의
확률 분포는 다음과 같다.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>X</p></th>
<th class="head text-center"><p>1</p></th>
<th class="head text-center"><p>2</p></th>
<th class="head text-center"><p>3</p></th>
<th class="head text-center"><p>4</p></th>
<th class="head text-center"><p>5</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>확률</p></td>
<td class="text-center"><p>0.041372</p></td>
<td class="text-center"><p>0.333011</p></td>
<td class="text-center"><p>0.361017</p></td>
<td class="text-center"><p>0.177992</p></td>
<td class="text-center"><p>0.086607</p></td>
</tr>
</tbody>
</table>
</div>
<p>위 두 예제에서 확률변수가 가리키는 값은 <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, <span class="math notranslate nohighlight">\(x_3\)</span> … 등의 형식으로 하나, 둘, 셋 하며 셀 수 있다.
이런 값을 가리키는 확률변수를 <strong>이산 확률변수</strong><font size='2'>discrete random variable</font>,
이산 확률변수가 따르는 확률 분포를 <strong>이산 확률 분포</strong><font size='2'>discrete probability distribution</font>라 한다.</p>
<p><strong>예제: 소득 범주 이산 확률 분포</strong></p>
<p>캘리포니아 주택가격 데이터셋을 이용하여 앞서 언급된 소득 범주의 이산 확률 분포를 가리키는 데이터프레임을 직접 생성해본다.</p>
<p>캘리포니아 주택가격 데이터셋을 불러온 후에 가구중위소득과 주택중위가격만 활용한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_url</span><span class="o">+</span><span class="s2">&quot;california_housing.csv&quot;</span><span class="p">)</span>
<span class="n">housing</span> <span class="o">=</span> <span class="n">housing</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;median_income&#39;</span><span class="p">,</span> <span class="s1">&#39;median_house_value&#39;</span><span class="p">]]</span>
<span class="n">housing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.3252</td>
      <td>452600.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.3014</td>
      <td>358500.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2574</td>
      <td>352100.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.6431</td>
      <td>341300.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.8462</td>
      <td>342200.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20635</th>
      <td>1.5603</td>
      <td>78100.0</td>
    </tr>
    <tr>
      <th>20636</th>
      <td>2.5568</td>
      <td>77100.0</td>
    </tr>
    <tr>
      <th>20637</th>
      <td>1.7000</td>
      <td>92300.0</td>
    </tr>
    <tr>
      <th>20638</th>
      <td>1.8672</td>
      <td>84700.0</td>
    </tr>
    <tr>
      <th>20639</th>
      <td>2.3886</td>
      <td>89400.0</td>
    </tr>
  </tbody>
</table>
<p>20640 rows × 2 columns</p>
</div></div></div>
</div>
<p>중위주택가격이 50만을 초과하는 경우는 삭제하고 인덱스를 초기화한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_value_max</span> <span class="o">=</span> <span class="n">housing</span><span class="p">[</span><span class="s1">&#39;median_house_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="c1"># 500,001</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">housing</span><span class="p">[</span><span class="s1">&#39;median_house_value&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">house_value_max</span>
<span class="n">housing</span> <span class="o">=</span> <span class="n">housing</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
<span class="n">housing</span> <span class="o">=</span> <span class="n">housing</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">housing</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;district&#39;</span>
<span class="n">housing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
    <tr>
      <th>district</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.3252</td>
      <td>452600.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.3014</td>
      <td>358500.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2574</td>
      <td>352100.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.6431</td>
      <td>341300.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.8462</td>
      <td>342200.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19670</th>
      <td>1.5603</td>
      <td>78100.0</td>
    </tr>
    <tr>
      <th>19671</th>
      <td>2.5568</td>
      <td>77100.0</td>
    </tr>
    <tr>
      <th>19672</th>
      <td>1.7000</td>
      <td>92300.0</td>
    </tr>
    <tr>
      <th>19673</th>
      <td>1.8672</td>
      <td>84700.0</td>
    </tr>
    <tr>
      <th>19674</th>
      <td>2.3886</td>
      <td>89400.0</td>
    </tr>
  </tbody>
</table>
<p>19675 rows × 2 columns</p>
</div></div></div>
</div>
<p>중위소득 범주 특성을 추가한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing</span><span class="p">[</span><span class="s2">&quot;income_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">housing</span><span class="p">[</span><span class="s2">&quot;median_income&quot;</span><span class="p">],</span>
                               <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span>
                               <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">housing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median_income</th>
      <th>median_house_value</th>
      <th>income_cat</th>
    </tr>
    <tr>
      <th>district</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.3252</td>
      <td>452600.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.3014</td>
      <td>358500.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2574</td>
      <td>352100.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.6431</td>
      <td>341300.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.8462</td>
      <td>342200.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19670</th>
      <td>1.5603</td>
      <td>78100.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19671</th>
      <td>2.5568</td>
      <td>77100.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19672</th>
      <td>1.7000</td>
      <td>92300.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19673</th>
      <td>1.8672</td>
      <td>84700.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19674</th>
      <td>2.3886</td>
      <td>89400.0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>19675 rows × 3 columns</p>
</div></div></div>
</div>
<p>소득 범주별로 그룹화하고 구간별 도수와 상대도수를 확인한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_stratification</span> <span class="o">=</span> <span class="n">housing</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;income_cat&#39;</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_stratified_count</span> <span class="o">=</span> <span class="n">x_stratification</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">x_stratified_ratio</span> <span class="o">=</span> <span class="n">x_stratified_count</span><span class="o">/</span><span class="p">(</span><span class="n">housing</span><span class="o">.</span><span class="n">shape</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x_stratified_ratio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median_income</th>
    </tr>
    <tr>
      <th>income_cat</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.041372</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.333011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.361017</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.177992</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.086607</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>위 데이터프레임을 이용하여 소득 범주에 대한 확률 분포를 구한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터프레임으로 변환</span>
<span class="n">prob_income</span> <span class="o">=</span> <span class="n">x_stratified_ratio</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># 컬럼과 인덱스 이름 지정</span>
<span class="n">prob_income</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;확률&#39;</span><span class="p">]</span>
<span class="n">prob_income</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>

<span class="c1"># 가로형의 데이터프레임으로 변환</span>
<span class="n">prob_income</span> <span class="o">=</span> <span class="n">prob_income</span><span class="o">.</span><span class="n">T</span>
<span class="n">prob_income</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>X</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>확률</th>
      <td>0.041372</td>
      <td>0.333011</td>
      <td>0.361017</td>
      <td>0.177992</td>
      <td>0.086607</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="pmf">
<h3><span class="section-number">12.1.1. </span>확률 질량 함수(PMF)<a class="headerlink" href="#pmf" title="Link to this heading">#</a></h3>
<p>이산 확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 가리키는 값이 <span class="math notranslate nohighlight">\(x\)</span>이고 <span class="math notranslate nohighlight">\(x\)</span>가 발생할 확률이 <span class="math notranslate nohighlight">\(p\)</span>일 때 다음과 같이 표기한다.</p>
<div class="math notranslate nohighlight">
\[
P(X=x) = p
\]</div>
<p>확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(x\)</span>를 취할 수 있는 확률을 계산하는
<strong>확률 질량 함수</strong><font size='2'>probability mass function</font>(PMF)함수 <span class="math notranslate nohighlight">\(f\)</span>를 다음과 같이 정의한다.</p>
<div class="math notranslate nohighlight">
\[
f(x) = P(X = x)
\]</div>
<p><strong>예제: 소득 범주의 PMF</strong></p>
<p>소득 범주의 PMF는 다음과 같이 정의할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_income</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">prob_income</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>예를 들어 임의의 구역의 소득 범주가 2일 확률은 약 33.3%다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_income</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.333011
</pre></div>
</div>
</div>
</div>
<p><strong>확률의 성질</strong></p>
<p>이산 확률 분포가 주어졌을 때 모든 경우에 대한 확률은 0과 1사이의 부동소수점이고,
모든 확률의 합은 1이다.
즉 다음이 성립해야 한다.</p>
<ul>
<li><p>첫째, 확률변수가 취할 수 있는 임의의 값 <span class="math notranslate nohighlight">\(x_k\)</span>에 대한 확률은 0과 1 사이의 값이다.</p>
<div class="math notranslate nohighlight">
\[0 \le f(x_k) \le 1\]</div>
</li>
<li><p>둘째, 확률변수가 취할 수 있는 모든 값에 대한 확률의 합은 1이다.</p>
<div class="math notranslate nohighlight">
\[\sum_k f(x_k) = 1\]</div>
</li>
</ul>
<p>소득 범주의 확률변수 또한 위 성질을 만족한다.</p>
<ul class="simple">
<li><p>모든 확률은 0과 1사이의 값</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">prob_income</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">prob_income</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>X</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>확률</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>다음 방식도 가능하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">prob_income</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">prob_income</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>확률    True
dtype: bool
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>모든 확률의 합은 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_income</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>확률    1.0
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="cdf">
<h3><span class="section-number">12.1.2. </span>누적 분포 함수(CDF)<a class="headerlink" href="#cdf" title="Link to this heading">#</a></h3>
<p>확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(x\)</span>보다 같거나 작은 값을 가질 확률을 계산하는 함수를
<strong>누적 분포 함수</strong><font size='2'>cumulative distribution function</font>(CDF)라고 부르며
아래처럼 정의된다.</p>
<div class="math notranslate nohighlight">
\[
F(x) = P(X \le x) = \sum_{x_k \le x} f(x_k)
\]</div>
<p><strong>소득 범주의 CDF</strong></p>
<p>소득 범주의 CDF 또한 <code class="docutils literal notranslate"><span class="pre">prob_income</span></code>을 이용하여 정의된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">income_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">prob_income</span><span class="p">[</span><span class="n">x_k</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_k</span> <span class="ow">in</span> <span class="n">prob_income</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">x_k</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>예를 들어 소득 범주가 1부터 3까지에 속할 확률은 약 73.5%다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income_cdf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.735400
</pre></div>
</div>
</div>
</div>
<p>모든 소득 범주의 합이 1임을 아래 방식으로도 확인한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income_cdf</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.000000
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id3">
<h2><span class="section-number">12.2. </span>다변량 분포<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p><strong>다변량 분포</strong><font size='2'>multivariate distribution</font>는
여러 개의 확률변수들이 결합된 확률 분포다.
여기서는 두 개의 이산 확률변수가 결합된 다변량 분포를 소개한다.</p>
<div class="note admonition">
<p class="admonition-title">단변량 분포</p>
<p>앞서 살펴 본 소득 범주를 가리키는 확률변수처럼
하나의 확률변수에 대한 확률 분포는 <strong>단변량 분포</strong><font size='2'>univariate distribution</font>라 한다.</p>
</div>
<section id="id4">
<h3><span class="section-number">12.2.1. </span>이산 결합 확률 분포<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span> 두 개의 이산 확률변수가 주어졌을 때 <span class="math notranslate nohighlight">\((X, Y)\)</span>는 각각의 확률변수가 취할 수 있는 값들의 조합을 가리키는 결합 확률변수다.
결합 확률변수 <span class="math notranslate nohighlight">\((X, Y)\)</span>가 가리키는 값들이 발생할 가능성의 확률 분포를
<strong>이산 결합 확률 분포</strong><font size='2'>discrete joint probability distribution</font>라 부른다.
이산 결합 확률 분포의 확률 질량 함수는 <strong>결합 확률 질량 함수</strong><font size='2'>joint probability mass function</font>로 정의되며,
확률변수 <span class="math notranslate nohighlight">\(X\)</span>는 <span class="math notranslate nohighlight">\(x\)</span>를, 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>는 <span class="math notranslate nohighlight">\(y\)</span>를 취할 확률을</p>
<div class="math notranslate nohighlight">
\[
f_{XY}(x, y) = P(X=x, Y=y) = p
\]</div>
<p>로 표현한다.
경우에 따라 아래처럼 표현되기도 한다.</p>
<div class="math notranslate nohighlight">
\[
f_{XY}(x, y) = P(X=x \;\cap\; Y=y) = p
\]</div>
<p>또는</p>
<div class="math notranslate nohighlight">
\[
f_{XY}(x, y) = P(X=x \;\;\text{and}\;\; Y=y) = p
\]</div>
<p><strong>예제: 소득 범주와 주택가격 범주</strong></p>
<p>캘리포니아 주택가격에 데이터셋에 포함된 중위주택가격을 지정된 가격 구간으로 나눠 새로운 이산 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>를 선언한다.
먼저 주택가격 범주를 소득 범주와 유사한 방식으로 추가한다.</p>
<p>중위주택가격의 범위는 14,999부터 500,000까지다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing</span><span class="o">.</span><span class="n">median_house_value</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     19675.000000
mean     192477.921017
std       97711.509613
min       14999.000000
25%      116600.000000
50%      173800.000000
75%      248200.000000
max      500000.000000
Name: median_house_value, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>중위주택가격의 사분위수 정보를 이용하여 중위주택가격을 6개 범주로 나눈다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing</span><span class="p">[</span><span class="s2">&quot;value_cat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">housing</span><span class="p">[</span><span class="s2">&quot;median_house_value&quot;</span><span class="p">],</span>
                              <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50_000</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">,</span> <span class="mi">150_000</span><span class="p">,</span> <span class="mi">250_000</span><span class="p">,</span> <span class="mi">400_000</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span>
                              <span class="n">labels</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="n">housing</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median_income</th>
      <th>median_house_value</th>
      <th>income_cat</th>
      <th>value_cat</th>
    </tr>
    <tr>
      <th>district</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8.3252</td>
      <td>452600.0</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.3014</td>
      <td>358500.0</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.2574</td>
      <td>352100.0</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.6431</td>
      <td>341300.0</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.8462</td>
      <td>342200.0</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19670</th>
      <td>1.5603</td>
      <td>78100.0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19671</th>
      <td>2.5568</td>
      <td>77100.0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19672</th>
      <td>1.7000</td>
      <td>92300.0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19673</th>
      <td>1.8672</td>
      <td>84700.0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19674</th>
      <td>2.3886</td>
      <td>89400.0</td>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>19675 rows × 4 columns</p>
</div></div></div>
</div>
<p>중위주택가격 범주별로 그룹화하고 그룹별 도수와 상대도수를 확인한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_stratification</span> <span class="o">=</span> <span class="n">housing</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;value_cat&#39;</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">group_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y_stratified_count</span> <span class="o">=</span> <span class="n">y_stratification</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">y_stratified_ratio</span> <span class="o">=</span> <span class="n">y_stratified_count</span><span class="o">/</span><span class="p">(</span><span class="n">housing</span><span class="o">.</span><span class="n">shape</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y_stratified_ratio</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median_house_value</th>
    </tr>
    <tr>
      <th>value_cat</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.010673</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.175248</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.201372</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.367878</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.205235</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.039593</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>중위주택가격 범주에 대한 확률 분포는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_value</span> <span class="o">=</span> <span class="n">y_stratified_ratio</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">prob_value</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;확률&#39;</span><span class="p">]</span>
<span class="n">prob_value</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>

<span class="n">prob_value</span> <span class="o">=</span> <span class="n">prob_value</span><span class="o">.</span><span class="n">T</span>
<span class="n">prob_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Y</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>확률</th>
      <td>0.010673</td>
      <td>0.175248</td>
      <td>0.201372</td>
      <td>0.367878</td>
      <td>0.205235</td>
      <td>0.039593</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>참고로 소득 범주에 대한 확률 분포는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_income</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>X</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>확률</th>
      <td>0.041372</td>
      <td>0.333011</td>
      <td>0.361017</td>
      <td>0.177992</td>
      <td>0.086607</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong><span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span>의 확률 질량 함수</strong></p>
<p>여러 개의 확률변수를 사용하기에 각각의 확률 질량 함수도 통일된 방식으로 이름을 짓는 게
편리하다.</p>
<p>먼저 <span class="math notranslate nohighlight">\(X\)</span>의 확률 질량 함수는 앞서 정의한 <code class="docutils literal notranslate"><span class="pre">f_income()</span></code> 함수다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_X</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f_income</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의 확률 질량 함수는 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_Y</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">prob_value</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>결합 확률 질량 함수(Joint PMF)</strong></p>
<p>캘리포니아 주택가격 데이터셋에 포함된 총 19,675개의 구역에서 한 구역을
임의로 선택했을 때 해당 구역의 소득 범주는4, 주택가격 범주는 3일 확률을 계산해보자.</p>
<p>먼저 두 확률변수 <span class="math notranslate nohighlight">\(X\)</span>와 <span class="math notranslate nohighlight">\(Y\)</span>는 상호 독립적인 관계가 아닐 가능성이 높음에 주의한다.
이유는 일반적으로 소득이 높은 지역일수록 주택가격이 높은 편이기 때문이다.
실제로 두 특성 사이의 상관계수가 0.64 정도로 매우 높은 편이며,
이는 <span class="math notranslate nohighlight">\(P(X=4, Y=3)\)</span>와 <span class="math notranslate nohighlight">\(P(X=4)\cdot P(Y=3)\)</span>가 다를 가능성이 매우 높음을 의미한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>median_income</th>
      <th>median_house_value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>median_income</th>
      <td>1.000000</td>
      <td>0.642611</td>
    </tr>
    <tr>
      <th>median_house_value</th>
      <td>0.642611</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>결합 확률 질량 함수 <span class="math notranslate nohighlight">\(P(X=x, Y=y)\)</span>는 두 개의 확률변수 <span class="math notranslate nohighlight">\(X\)</span>와 <span class="math notranslate nohighlight">\(Y\)</span>가 가질 수 있는 값들의 조합에 대한 확률을 계산한다.
따라서 두 확률변수가 가리키는 값들의 조합이 발생하는 경우가 얼마나 많은지를 확인하면 된다.
<code class="docutils literal notranslate"><span class="pre">pd.crosstab()</span></code> 함수를 이용하면 간단하게 모든 조합의 경우를 포함하는 도수분포표를 작성할 수 있다.</p>
<p>먼저 소득 범주와 주택가격 범주만 따로 다룬다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">two_cats</span> <span class="o">=</span> <span class="n">housing</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">two_cats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income_cat</th>
      <th>value_cat</th>
    </tr>
    <tr>
      <th>district</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19670</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19671</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19672</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19673</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19674</th>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>19675 rows × 2 columns</p>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pd.crosstab()</span></code> 함수를 적용하면 두 범주 특성에 대한 <strong>교차표</strong><font size='2'>cross table</font>를 생성한다.
교차표엔 두 범주 특성의 가능한 모든 조합에 대한 도수가 포함된다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">margins=True</span></code> 키워드 인자: 행과 열별 도수의 합 포함</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cats_crossed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">two_cats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">two_cats</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cats_crossed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>value_cat</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>All</th>
    </tr>
    <tr>
      <th>income_cat</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>72</td>
      <td>436</td>
      <td>159</td>
      <td>108</td>
      <td>33</td>
      <td>6</td>
      <td>814</td>
    </tr>
    <tr>
      <th>2</th>
      <td>131</td>
      <td>2335</td>
      <td>1880</td>
      <td>1799</td>
      <td>358</td>
      <td>49</td>
      <td>6552</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>650</td>
      <td>1652</td>
      <td>3343</td>
      <td>1273</td>
      <td>179</td>
      <td>7103</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>24</td>
      <td>251</td>
      <td>1753</td>
      <td>1289</td>
      <td>184</td>
      <td>3502</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>20</td>
      <td>235</td>
      <td>1085</td>
      <td>361</td>
      <td>1704</td>
    </tr>
    <tr>
      <th>All</th>
      <td>210</td>
      <td>3448</td>
      <td>3962</td>
      <td>7238</td>
      <td>4038</td>
      <td>779</td>
      <td>19675</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>교차표에 인덱싱을 적용하면 임의의 <span class="math notranslate nohighlight">\(x\)</span>와 <span class="math notranslate nohighlight">\(y\)</span>에 대해 <span class="math notranslate nohighlight">\(P(X=x, Y=y)\)</span>를 계산할 수 있다.
예를 들어 <span class="math notranslate nohighlight">\(P(X=4, Y=3)\)</span>는 다음과 같다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cats_crossed.loc[4,</span> <span class="pre">3]</span></code>: 소득 범주는 4, 주택가격 범주는 3인 경우의 도수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cats_crossed.loc['All',</span> <span class="pre">'All']</span></code>: 모집단 크기</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>251
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19675
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(P(X=4, Y=3)\)</span>는 따라서 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.012757
</pre></div>
</div>
</div>
</div>
<p>소득 범주와 주택가격 범주의 결합 확률 분포를 따르는 결합 확률 질량 함수는 따라서 다음과 같이 정의 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_XY</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">count</span> <span class="o">/</span> <span class="n">pop</span>
</pre></div>
</div>
</div>
</div>
<p>캘리포니아 주택가격 데이터셋에서 임의의 구역을 선택했을 때 소득 범주는 4, 주택가격 범주는 3인 경우의 확률은 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_XY</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.012757
</pre></div>
</div>
</div>
</div>
<p>캘리포니아 주택가격 데이터셋에서 임의의 구역을 선택했을 때 소득 범주는 5, 주택가격 범주는 6인 경우의 확률은 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_XY</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.018348
</pre></div>
</div>
</div>
</div>
<p>참고로 두 확률변수가 서로 영향을 주지 않는다면 위 결과가 아래 결과와 같아야 하는데 그렇지 않다.
즉, 두 확률변수는 서로 독립이 아니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_X</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_Y</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.003429
</pre></div>
</div>
</div>
</div>
<p><strong>확률의 성질</strong></p>
<p>이산 결합 확률 분포에 대해서도 모든 경우에 대한 확률은 0과 1사이의 부동소수점이고,
모든 확률의 합은 1이다.</p>
<p>첫째, 두 확률변수 <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span>가 취할 수 있는 임의의 값 <span class="math notranslate nohighlight">\(x\)</span>와 <span class="math notranslate nohighlight">\(y\)</span>에 대한 확률은 0과 1 사이의 값이다.</p>
<p>답: <code class="docutils literal notranslate"><span class="pre">P_XY()</span></code> 함수의 정의에 의해 아래 데이터프레임의 각 항목이 0과 1사이의 값을 확인한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_XY_df</span> <span class="o">=</span> <span class="n">cats_crossed</span> <span class="o">/</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
<span class="n">p_XY_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>value_cat</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>All</th>
    </tr>
    <tr>
      <th>income_cat</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.003659</td>
      <td>0.022160</td>
      <td>0.008081</td>
      <td>0.005489</td>
      <td>0.001677</td>
      <td>0.000305</td>
      <td>0.041372</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.006658</td>
      <td>0.118679</td>
      <td>0.095553</td>
      <td>0.091436</td>
      <td>0.018196</td>
      <td>0.002490</td>
      <td>0.333011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000305</td>
      <td>0.033037</td>
      <td>0.083964</td>
      <td>0.169911</td>
      <td>0.064701</td>
      <td>0.009098</td>
      <td>0.361017</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000051</td>
      <td>0.001220</td>
      <td>0.012757</td>
      <td>0.089098</td>
      <td>0.065515</td>
      <td>0.009352</td>
      <td>0.177992</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.000000</td>
      <td>0.000152</td>
      <td>0.001017</td>
      <td>0.011944</td>
      <td>0.055146</td>
      <td>0.018348</td>
      <td>0.086607</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.010673</td>
      <td>0.175248</td>
      <td>0.201372</td>
      <td>0.367878</td>
      <td>0.205235</td>
      <td>0.039593</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">p_XY_df</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">&gt;=</span> <span class="n">p_XY_df</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>둘째, 두 확률변수가 취할 수 있는 모든 조합에 대한 확률의 합은 1이다.</p>
<p>답: <code class="docutils literal notranslate"><span class="pre">p_XY_df.loc['All',</span> <span class="pre">'All']</span></code>이 1임을 확인하면 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_XY_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.000000
</pre></div>
</div>
</div>
</div>
<p><strong>이산 결합 확률 분포의 히트맵</strong></p>
<p>영역별 값의 크기를 색과 농도로 구분하는 히트맵을 이용하면
중위소득 범주와 중위주택가격 범주 사이의 연관성을 한 눈에 알아볼 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">p_XY_df</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># 마지막 행과 열 제외</span>
<span class="n">row</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="n">col</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="c1"># 히트맵</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">p_XY_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">row</span><span class="p">,</span> <span class="p">:</span><span class="n">col</span><span class="p">])</span>

<span class="c1"># 축 눈금 지정</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span> <span class="c1"># 소득 범주 위에서부터</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labeltop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># x-축 눈금 위쪽으로</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;House Value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Income&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span> <span class="c1"># 색 기둥</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ec7bd4d0c503b11a8d500e07f7e5f9bf96da223a29c82650a0b2dd9d9b308e8d.png" src="_images/ec7bd4d0c503b11a8d500e07f7e5f9bf96da223a29c82650a0b2dd9d9b308e8d.png" />
</div>
</div>
<p>대각선에 위치한 영역의 일반적으로 밝다.
특히 중위소득의 범주가 3, 중위주택가격의 범주가 4인 영역의 확률이 가장 높다.
일반적으로 소득 수준에 맞는 주택에 산다는 점과
중산층이 적절한 가격의 주택에 산다는 상식에 부합하는 결과를 보여준다.</p>
<p>반면에 각 확률변수의 확률 분포를 그래프로 그리면 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>

<span class="n">prob_income</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Marginal probability distribution for X&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Income&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>

<span class="n">prob_value</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Marginal probability distribution for Y&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;House value&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b1aaf7d2184f670b8ec5481f44dd691cf5b27fbdc59ab126cad9c494698e8160.png" src="_images/b1aaf7d2184f670b8ec5481f44dd691cf5b27fbdc59ab126cad9c494698e8160.png" />
</div>
</div>
</section>
<section id="id5">
<h3><span class="section-number">12.2.2. </span>조건부 확률<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(P(A\mid B)\)</span>는 사건 <span class="math notranslate nohighlight">\(B\)</span>가 일어났다는 전제 하에 사건 <span class="math notranslate nohighlight">\(A\)</span>가 발생할
<strong>조건부 확률</strong><font size='2'>conditional probability</font>을 나타내며,
아래 그림에서 파랑색 영역 <span class="math notranslate nohighlight">\(B\)</span>에서 보라색 영역이 차지하는 비율을 가리킨다.
반면에 조건부 확률과는 달리 <span class="math notranslate nohighlight">\(P(A)\)</span>, <span class="math notranslate nohighlight">\(P(B)\)</span>, <span class="math notranslate nohighlight">\(P(A, B)\)</span> 등은 전체 검정색 영역 <span class="math notranslate nohighlight">\(U\)</span>에서
각각의 영역이 차지하는 비율을 가리킨다.</p>
<p><div align="center"><img src="https://github.com/codingalzi/DataSci/blob/master/jupyter-book/images/conditional02.png?raw=true" style="width:300px"></div></p><p><span class="math notranslate nohighlight">\(P(A, B)\)</span>, 즉 <span class="math notranslate nohighlight">\(P(A \;\cap\; BB)\)</span> 는 전체 검정색 영역 <span class="math notranslate nohighlight">\(U\)</span>에서 보라색 영역이 차지하는 비율이며, 따라서 <span class="math notranslate nohighlight">\(P(A \mid B)\)</span>와
일반적으로 다르다.
하지만 다음 식이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
P(A\mid B) = \frac{P(A, B)}{P(B)}\qquad (\ast)
\]</div>
<p>이유는 위 그림에서 바로 알 수 있듯이 다음이 성립하기 때문이다.</p>
<div class="math notranslate nohighlight">
\[
P(A\mid B) = \frac{A \;\cap\; BB}{B} = \frac{\frac{A \;\cap\; BB}{U}}{\frac{B}{U}} = \frac{P(A \;\cap\; BB)}{P(B)}
\]</div>
<div class="example admonition">
<p class="admonition-title">예제</p>
<p>15명으로 구성된 동아리가 진행하는 행사에 참여하는 회원수가 다음과 같다.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p>여성(0)</p></th>
<th class="head text-center"><p>남성(1)</p></th>
<th class="head text-center"><p>합계</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>불참(0)</p></td>
<td class="text-center"><p>2</p></td>
<td class="text-center"><p>2</p></td>
<td class="text-center"><p>4</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>참여(1)</p></td>
<td class="text-center"><p>6</p></td>
<td class="text-center"><p>5</p></td>
<td class="text-center"><p>11</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>합계</p></td>
<td class="text-center"><p>8</p></td>
<td class="text-center"><p>7</p></td>
<td class="text-center"><p>15</p></td>
</tr>
</tbody>
</table>
</div>
<p>15명 중에 한 명을 임의로 선택할 때
확률변수 <span class="math notranslate nohighlight">\(X\)</span>는 행사 참여 여부를,
확률변수 <span class="math notranslate nohighlight">\(Y\)</span>는 여성회원 여부를 가리킨다고 하자.</p>
<p>그러면 임의로 선택된 사람이 여성일 때 그 여성이 행사에 참여할 확률
<span class="math notranslate nohighlight">\(P(X=1\mid Y=0)\)</span>은 총 8명 여성회원 중에서 행사에 참여하는
6명의 비율인 3/4이다.
반면에 임의로 선택된 사람이 행사에 참여하는 여성일 확률 <span class="math notranslate nohighlight">\(P(X=1, Y=0)\)</span>은
총 15명 중에 6명의 비율인 6/15이다.</p>
<p>15명 중에 8명이 여성이기에 <span class="math notranslate nohighlight">\(P(Y=0)=8/15\)</span>이다.
따라서 식 <span class="math notranslate nohighlight">\((*)\)</span>을 이용해도 동일한 조건부 확률을 얻는다.</p>
<div class="math notranslate nohighlight">
\[
P(X=1 \mid Y=0) = \frac{P(X=1, Y=0)}{P(Y=0)} = \frac{\frac{6}{15}}{\frac{8}{15}} = \frac 6 8 = \frac 3 4
\]</div>
</div>
<p><span class="math notranslate nohighlight">\(P(X=x\mid Y=y)\)</span>를 계산하기 위해 <span class="math notranslate nohighlight">\((*)\)</span>를 이용한다.</p>
<div class="math notranslate nohighlight">
\[
P(X=x\mid Y=y) = \frac{P(X=x, Y=y)}{P(Y=y)}
\]</div>
<p><code class="docutils literal notranslate"><span class="pre">X</span></code>와 <code class="docutils literal notranslate"><span class="pre">Y</span></code>의 역할을 바꾸면 다음도 성립한다.</p>
<div class="math notranslate nohighlight">
\[
P(Y=y\mid X=x) = \frac{P(Y=y, X=x)}{P(X=x)} = \frac{P(X=x, Y=y)}{P(X=x)}
\]</div>
<p><strong>조건부 확률 질량 함수</strong></p>
<p>조건부 확률을 계산하는 확률 질량 함수를 앞서 정의한 확률 질량 함수들을 이용하여
간단하게 정의할 수 있다.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(X=x \mid Y=y)\)</span> 계산 함수</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_XconY</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p_XY</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">p_Y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P(Y=y \mid X=x)\)</span> 계산 함수</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_YconX</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">p_XY</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">p_X</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>예를 들어 캘리포니아 주택가격 데이터셋에서 중위주택가격의 범주가 3인 구역을 임의로 하나 선택했을 때
해당 구역의 소득 범주가 4일 확률은 약 6.3%다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_XconY</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.063352
</pre></div>
</div>
</div>
</div>
<p>실제로 중위주택가격의 범주가 3인 경우의 도수는 3,962,
그중에 중위소득의 범주가 4인 경우의 도수는 251,
그리고 251/3962는 약 0.063이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3962
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>251
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">251</span> <span class="o">/</span> <span class="mi">3962</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.063352
</pre></div>
</div>
</div>
</div>
<p>참고로 두 확률변수가 서로 독립이라면 <code class="docutils literal notranslate"><span class="pre">p_XconY(4,</span> <span class="pre">3)</span></code>은 <code class="docutils literal notranslate"><span class="pre">p_X(4)</span></code>와 동일해야 하는데 그렇지 못하다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_X</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.177992
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">p_YconX(3,</span> <span class="pre">4)</span></code>와 <code class="docutils literal notranslate"><span class="pre">p_Y(3)</span></code> 또한 서로 다르다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_YconX</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.071673
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_Y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.201372
</pre></div>
</div>
</div>
</div>
<p>소득과 주택가격이 상호 영향을 준다는 사실이 다시 한 번 확인된다.</p>
</section>
<section id="id6">
<h3><span class="section-number">12.2.3. </span>주변 확률 분포<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>확률변수 <span class="math notranslate nohighlight">\((X, Y)\)</span>의 결합 확률 분포가 주어졌을 때
각각의 확률변수에 대한 확률 분포를
<strong>주변 확률 분포</strong><font size='2'>marginal probability distribution</font>라 한다.
확률변수 <span class="math notranslate nohighlight">\(X\)</span>의 주변 확률 질량 함수는 다음과 같이 정의된다.</p>
<div class="math notranslate nohighlight">
\[
f_X(x) = \sum_k f_{XY}(x, y_k) = \sum_k P(X=x, Y=y_k)
\]</div>
<p>반면에 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의 주변 확률 질량 함수는 다음과 같이 정의된다.</p>
<div class="math notranslate nohighlight">
\[
f_Y(y) = \sum_k f_{XY}(x_k, y) = \sum_k P(X=x_k, Y=y)
\]</div>
<p><span class="math notranslate nohighlight">\(f_X\)</span>는 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의 영향을 받지 않고 독립적으로 확률변수 <span class="math notranslate nohighlight">\(X\)</span>의 확률 분포를,
<span class="math notranslate nohighlight">\(f_Y\)</span>는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>의 영향을 받지 않고 독립적으로 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의 확률 분포를 계산한다.</p>
<p>캘리포니아 주택가격 데이터셋에서 소득 분포를 가리키는 확률변수 <span class="math notranslate nohighlight">\(X\)</span>와 주택중위가격 분포를 가리키는 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>에 대해
앞서 선언된 이산 결합 확률 분포의 결합 PMF인 <code class="docutils literal notranslate"><span class="pre">p_XY()</span></code> 함수를 이용하여
각각의 확률변수에 대한 주변 확률 질량 함수를 구해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_X</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">prob_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p_XY</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">prob_x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_Y</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="n">prob_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p_XY</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">prob_y</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>그런데 <code class="docutils literal notranslate"><span class="pre">p_XY()</span></code> 함수의 정의가 다음과 같다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">p_XY</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">count</span> <span class="o">/</span> <span class="n">pop</span>
</pre></div>
</div>
<p>따라서 각 확률변수의 주변 확률 질량 함수를 다음과 같이 정의해도 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_X1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">count</span> <span class="o">/</span> <span class="n">pop</span>   
</pre></div>
</div>
</div>
</div>
<p>이유는 <code class="docutils literal notranslate"><span class="pre">cats_crossed.loc[x,</span> <span class="pre">'All']</span></code>가
확률변수 <span class="math notranslate nohighlight">\(X\)</span>가 <span class="math notranslate nohighlight">\(x\)</span>를 가리킬 때의 모든 <span class="math notranslate nohighlight">\(y\)</span>에 대한 도수의 합을 가리키기 때문이다.
동일한 이유로 확률변수 <span class="math notranslate nohighlight">\(Y\)</span>의 주변 확률 분포를 다음과 같이 정의할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_Y1</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">cats_crossed</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;All&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">count</span> <span class="o">/</span> <span class="n">pop</span>   
</pre></div>
</div>
</div>
</div>
<p>이전의 정의와 동일한 확률을 계산함을 다음과 같이 보인다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">([</span><span class="n">f_X</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="p">[</span><span class="n">f_X1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">([</span><span class="n">f_Y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)],</span> <span class="p">[</span><span class="n">f_Y1</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>참고로 <code class="docutils literal notranslate"><span class="pre">np.allclose()</span></code> 함수는 부동소수점으로 구성된 두 어레이에 대해
동일한 인덱스의 두 부동소수점이 허용된 오차 범위 내에 위치하는가를 확인한다.
이 함수를 사용하는 이유는 모든 항목에 대해 부동소수점의 동일여부를 물으면 다르다고 판정되기 때문이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">([</span><span class="n">f_X</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="p">[</span><span class="n">f_X1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>예를 들어 다음이 성립한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">f_X1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>그런데 두 값을 개별적으로 확인하면 동일해 보인다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.361017
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_X1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.361017
</pre></div>
</div>
</div>
</div>
<p>하지만 이는 부동소수점을 소수점 이하 여섯째 자리까지만 화면에 보이도록 설정했기 때문이다.
소수점 이하 스무번째 자리까지 출력하면 두 함수의 결과가 소수점 이하 열일곱번째 자리에서 다르다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">precision</span> 20
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;%.20f&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.36101651842439647089
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_X1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.36101651842439641538
</pre></div>
</div>
</div>
</div>
<p>하지만 두 함수의 결과가 이론적으로 동일해야 함에도 불구하고
다르게 계산되는 이유는 두 함수가 서로 다른 방식으로 부동소수점 연산을 실행하기 때문이다.
즉, 부동소수점의 연산의 한계 때문이다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f_X(x)</span></code>: 모든 <code class="docutils literal notranslate"><span class="pre">y</span></code>에 대해 먼저 <code class="docutils literal notranslate"><span class="pre">P(X=x,</span> <span class="pre">Y=y)</span></code>, 즉 확률을 계산한 다음에 더함.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f_X1(x)</span></code>: <code class="docutils literal notranslate"><span class="pre">x</span></code>의 범주에 속하는 도수를 모두 더한 다음에 확률 계산.</p></li>
</ul>
<p>반면에 <code class="docutils literal notranslate"><span class="pre">f_X1()</span></code>과 <code class="docutils literal notranslate"><span class="pre">f_Y1()</span></code>은 앞서 정의한 확률 질량 함수 <code class="docutils literal notranslate"><span class="pre">p_X()</span></code>, <code class="docutils literal notranslate"><span class="pre">p_Y()</span></code>와 각각 완전히 동일한
확률을 계산한다.
이유는 <code class="docutils literal notranslate"><span class="pre">p_X()</span></code>, <code class="docutils literal notranslate"><span class="pre">p_Y()</span></code>또한 먼저 도수를 합한 다음에 확률을 계산하기 때문이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">([</span><span class="n">p_X</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)],</span> <span class="p">[</span><span class="n">f_X1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">([</span><span class="n">p_Y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)],</span> <span class="p">[</span><span class="n">f_Y1</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>결론적으로 두 확률변수의 확률 질량 함수는 결합 확률 질량 함수를 이용하여 정의된
확률 질량 함수와 동일하다.</p>
</section>
</section>
<section id="id7">
<h2><span class="section-number">12.3. </span>연습문제<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<p>참고: <a class="reference external" href="https://colab.research.google.com/github/codingalzi/DataSci/blob/master/practices/practice-probability_discrete.ipynb">(연습) 이산 확률 분포</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="probability.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">11. </span>확률 분포</p>
      </div>
    </a>
    <a class="right-next"
       href="probability_continuous.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">13. </span>연속 확률 분포</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">12.1. 이산 확률변수</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pmf">12.1.1. 확률 질량 함수(PMF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdf">12.1.2. 누적 분포 함수(CDF)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">12.2. 다변량 분포</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">12.2.1. 이산 결합 확률 분포</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">12.2.2. 조건부 확률</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">12.2.3. 주변 확률 분포</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">12.3. 연습문제</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 코딩알지
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>